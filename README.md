# Минимальная инфра для установки битрикса
## Установка
1. Склонировать репозиторий
2. [Скачать дистрибутив битрикс](https://www.1c-bitrix.ru/download/cms.php#tab-subsection-3)
3. Распаковать дитрибутив и поместить содержимое в папку ./bitrix
4. Выполнить команду docker compose up
   1. Будут построены образы
   2. Запущены контейнеры
5. Перейти по адресу http://localhost или http://127.0.0.1 где должен появится установщик битрикс
6. На шаге указания данных бд указать адрес `db` для того, чтобы контейнер php успешно соединился с конейтнером db тем самым подключившись к базе данных.

## Импорт дампа в бд
При работе возможно возникновение ситуации при которой понадобится импортировать дамп в бд. СУБД у нас в контейнере db (mysql). Для того чтобы осуществить импорт необходимо выполнить следующие шаги.
1. В папку mysql/dump поместить dump
2. Подключиться к запущенному контейнеру db
```bash
docker exec -it db bash
```
3. Произвести импорт 
```bash
mysql -u root --password=123 bitrix < /dump/<dump_name>.sql
```
4. При возникновении ошибок может понадобиться удалить существующую таблицу bitrix в СУБД, создать чистую и повторить попытку импорта.

## Примечание
Проверялось на OS X, может понадобиться удалить строку `platform: linux/amd64` для контейнера db в [docker compose](docker-compose.yaml) файле.